<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Diurnal, day of the week and monthly variation — timeVariation • openair</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Diurnal, day of the week and monthly variation — timeVariation" />
<meta property="og:description" content="Plots the diurnal, day of the week and monthly variation for
different variables, typically pollutant concentrations. Four
separate plots are produced." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openair</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/davidcarslaw/openair">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Diurnal, day of the week and monthly variation</h1>
    
    <div class="hidden name"><code>timeVariation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plots the diurnal, day of the week and monthly variation for
different variables, typically pollutant concentrations. Four
separate plots are produced.</p>
    </div>

    <pre class="usage"><span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>pollutant</span> <span class='kw'>=</span> <span class='st'>"nox"</span>, <span class='kw'>local.tz</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>normalise</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"hour"</span>, <span class='st'>"hour"</span>, <span class='st'>"month"</span>, <span class='st'>"weekday"</span>),
  <span class='kw'>name.pol</span> <span class='kw'>=</span> <span class='no'>pollutant</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"default"</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>difference</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>statistic</span> <span class='kw'>=</span> <span class='st'>"mean"</span>, <span class='kw'>conf.int</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>ci</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"hue"</span>, <span class='kw'>ref.y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>key</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>key.columns</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>start.day</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>auto.text</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.4</span>,
  <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mydata</th>
      <td><p>A data frame of hourly (or higher temporal resolution data).
Must include a <code>date</code> field and at least one variable to plot.</p></td>
    </tr>
    <tr>
      <th>pollutant</th>
      <td><p>Name of variable to plot. Two or more pollutants can be
plotted, in which case a form like <code>pollutant = c("nox", "co")</code>
should be used.</p></td>
    </tr>
    <tr>
      <th>local.tz</th>
      <td><p>Should the results be calculated in local time
that includes a treatment of daylight savings time (DST)? The
default is not to consider DST issues, provided the data were
imported without a DST offset. Emissions activity tends to occur
at local time e.g. rush hour is at 8 am every day. When the clocks
go forward in spring, the emissions are effectively released into
the atmosphere typically 1 hour earlier during the summertime
i.e. when DST applies. When plotting diurnal profiles, this has
the effect of &#8220;smearing-out&#8221; the concentrations. Sometimes,
a useful approach is to express time as local time. This
correction tends to produce better-defined diurnal profiles of
concentration (or other variables) and allows a better comparison
to be made with emissions/activity data. If set to <code>FALSE</code>
then GMT is used. Examples of usage include <code>local.tz =
"Europe/London"</code>, <code>local.tz = "America/New_York"</code>. See
<code>cutData</code> and <code>import</code> for more details.</p></td>
    </tr>
    <tr>
      <th>normalise</th>
      <td><p>Should variables be normalised? The default is
<code>FALSE</code>. If <code>TRUE</code> then the variable(s) are divided by their
mean values. This helps to compare the shape of the diurnal trends for
variables on very different scales.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>x-axis label; one for each sub-plot.</p></td>
    </tr>
    <tr>
      <th>name.pol</th>
      <td><p>Names to be given to the pollutant(s). This is useful if
you want to give a fuller description of the variables, maybe also
including subscripts etc.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p><code>type</code> determines how the data are split
i.e. conditioned, and then plotted. The default is will produce a
single plot using the entire data. Type can be one of the built-in
types as detailed in <code>cutData</code> e.g. &#8220;season&#8221;,
&#8220;year&#8221;, &#8220;weekday&#8221; and so on. For example, <code>type
= "season"</code> will produce four plots --- one for each season.</p>
<p>It is also possible to choose <code>type</code> as another variable in the data
  frame. If that variable is numeric, then the data will be split into four
  quantiles (if possible) and labelled accordingly. If type is an existing
  character or factor variable, then those categories/levels will be used
  directly. This offers great flexibility for understanding the variation
  of different variables and how they depend on one another.</p>
<p>Only one <code>type</code> is allowed in<code>timeVariation</code>.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>This sets the grouping variable to be used. For example, if a
data frame had a column <code>site</code> setting <code>group = "site"</code> will
plot all sites together in each panel. See examples below.</p></td>
    </tr>
    <tr>
      <th>difference</th>
      <td><p>If two pollutants are chosen then setting
<code>difference = TRUE</code> will also plot the difference in means
between the two variables as <code>pollutant[2] -
pollutant[1]</code>. Bootstrap 95% confidence intervals of the
difference in means are also calculated. A horizontal dashed line
is shown at y = 0.</p></td>
    </tr>
    <tr>
      <th>statistic</th>
      <td><p>Can be &#8220;mean&#8221; (default) or
&#8220;median&#8221;. If the statistic is &#8216;mean&#8217; then the mean
line and the 95% confidence interval in the mean are plotted by
default. If the statistic is &#8216;median&#8217; then the median line
is plotted together with the 5/95 and 25/75th quantiles are
plotted. Users can control the confidence intervals with
<code>conf.int</code>.</p></td>
    </tr>
    <tr>
      <th>conf.int</th>
      <td><p>The confidence intervals to be plotted. If
<code>statistic = "mean"</code> then the confidence intervals in the
mean are plotted. If <code>statistic = "median"</code> then the
<code>conf.int</code> and <code>1 - conf.int</code> <em>quantiles</em> are
plotted. <code>conf.int</code> can be of length 2, which is most useful
for showing quantiles. For example <code>conf.int = c(0.75, 0.99)</code>
will yield a plot showing the median, 25/75 and 5/95th quantiles.</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>Number of bootstrap replicates to use. Can be useful to
reduce this value when there are a large number of observations
available to increase the speed of the calculations without
affecting the 95% confidence interval calculations by much.</p></td>
    </tr>
    <tr>
      <th>ci</th>
      <td><p>Should confidence intervals be shown? The default is <code>TRUE</code>.
Setting this to <code>FALSE</code> can be useful if multiple pollutants are
chosen where over-lapping confidence intervals can over complicate plots.</p></td>
    </tr>
    <tr>
      <th>cols</th>
      <td><p>Colours to be used for plotting. Options include
&#8220;default&#8221;, &#8220;increment&#8221;, &#8220;heat&#8221;, &#8220;jet&#8221;
and <code>RColorBrewer</code> colours --- see the <code>openair</code>
<code>openColours</code> function for more details. For user defined the
user can supply a list of colour names recognised by R (type
<code><a href='https://rdrr.io/r/grDevices/colors.html'>colours()</a></code> to see the full list). An example would be
<code>cols = c("yellow", "green", "blue")</code></p></td>
    </tr>
    <tr>
      <th>ref.y</th>
      <td><p>A list with details of the horizontal lines to be
added representing reference line(s). For example, <code>ref.y =
list(h = 50, lty = 5)</code> will add a dashed horizontal line at
50. Several lines can be plotted e.g. <code>ref.y = list(h = c(50,
100), lty = c(1, 5), col = c("green", "blue"))</code>. See
<code>panel.abline</code> in the <code>lattice</code> package for more details
on adding/controlling lines.</p></td>
    </tr>
    <tr>
      <th>key</th>
      <td><p>By default <code>timeVariation</code> produces four plots on
one page.  While it is useful to see these plots together, it is
sometimes necessary just to use one for a report. If <code>key</code> is
<code>TRUE</code>, a key is added to all plots allowing the extraction
of a single plot <em>with</em> key. See below for an example.</p></td>
    </tr>
    <tr>
      <th>key.columns</th>
      <td><p>Number of columns to be used in the key. With many
pollutants a single column can make to key too wide. The user can thus
choose to use several columns by setting <code>columns</code> to be less than
the number of pollutants.</p></td>
    </tr>
    <tr>
      <th>start.day</th>
      <td><p>What day of the week should the plots start on?
The user can change the start day by supplying an integer between
0 and 6. Sunday = 0, Monday = 1, ... For example to start the
weekday plots on a Saturday, choose <code>start.day = 6</code>.</p></td>
    </tr>
    <tr>
      <th>auto.text</th>
      <td><p>Either <code>TRUE</code> (default) or <code>FALSE</code>. If
<code>TRUE</code> titles and axis labels will automatically try and format
pollutant names and units properly e.g.  by subscripting the &#8216;2&#8217; in NO2.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>The alpha transparency used for plotting confidence intervals.
0 is fully transparent and 1 is opaque. The default is 0.4</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other graphical parameters passed onto <code>lattice:xyplot</code>
and <code>cutData</code>. For example, in the case of <code>cutData</code> the option
<code>hemisphere = "southern"</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>As well as generating the plot itself, <code>timeVariation</code> also
  returns an object of class ``openair''. The object includes three main
  components: <code>call</code>, the command used to generate the plot;
  <code>data</code>, the data used to make the four components of the plot (or
  subplots); and <code>plot</code>, the associated subplots.  If retained, e.g.
  using <code>output &lt;- timeVariation(mydata, "nox")</code>, this output can be
  used to recover the data, reproduce or rework the original plot or
  undertake further analysis.</p>
<p>An openair output can be manipulated using a number of generic operations,
  including <code>print</code>, <code>plot</code> and <code>summary</code>.</p>
<p>The four components of timeVariation are: <code>day.hour</code>, <code>hour</code>,
  <code>day</code> and <code>month</code>. Associated data.frames can be extracted
  directly using the <code>subset</code> option, e.g. as in <code><a href='https://rdrr.io/r/graphics/plot.html'>plot(object,
  subset = "day.hour")</a></code>, <code><a href='https://rdrr.io/r/base/summary.html'>summary(output, subset = "hour")</a></code>, etc, for
  <code>output &lt;- timeVariation(mydata, "nox")</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The variation of pollutant concentrations by hour of the day and
day of the week etc. can reveal many interesting features that
relate to source types and meteorology. For traffic sources, there
are often important differences in the way vehicles vary by
vehicles type e.g. less heavy vehicles at weekends.</p>
<p>The <code>timeVariation</code> function makes it easy to see how
concentrations (and many other variable types) vary by hour of the
day and day of the week.</p>
<p>The plots also show the 95% confidence intervals in the mean. The
95% confidence intervals in the mean are calculated through
bootstrap simulations, which will provide more robust estimates of
the confidence intervals (particularly when there are relatively
few data).</p>
<p>The function can handle multiple pollutants and uses the flexible
<code>type</code> option to provide separate panels for each 'type' ---
see <code>cutData</code> for more details. <code>timeVariation</code> can also
accept a <code>group</code> option which is useful if data are
stacked. This will work in a similar way to having multiple
pollutants in separate columns.</p>
<p>The user can supply their own <code>ylim</code> e.g. <code>ylim = c(0,
200)</code> that will be used for all plots. <code>ylim</code> can also be a
list of length four to control the y-limits on each individual
plot e.g. <code>ylim = list(c(-100,500), c(200, 300), c(-400,400),
c(50,70))</code>. These pairs correspond to the hour, weekday, month and
day-hour plots respectively.</p>
<p>The option <code>difference</code> will calculate the difference in
means of two pollutants together with bootstrap estimates of the
95% confidence intervals in the difference in the mean. This works
in two ways: either two pollutants are supplied in separate
columns e.g. <code>pollutant = c("no2", "o3")</code>, or there are two
unique values of <code>group</code>. The difference is calculated as the
second pollutant minus the first and is labelled as
such. Considering differences in this way can provide many useful
insights and is particularly useful for model evaluation when
information is needed about where a model differs from
observations by many different time scales. The manual contains
various examples of using <code>difference = TRUE</code>.</p>
<p>Note also that the <code>timeVariation</code> function works well on a
subset of data and in conjunction with other plots. For example, a
<code><a href='polarPlot.html'>polarPlot</a></code> may highlight an interesting feature for a
particular wind speed/direction range. By filtering for those
conditions <code>timeVariation</code> can help determine whether the
temporal variation of that feature differs from other features ---
and help with source identification.</p>
<p>In addition, <code>timeVariation</code> will work well with other variables if
available. Examples include meteorological and traffic flow data.</p>
<p>Depending on the choice of statistic, a subheading is added. Users
can control the text in the subheading through the use of
<code>sub</code> e.g. <code>sub = ""</code> will remove any subheading.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='polarPlot.html'>polarPlot</a></code>, <code><a href='linearRelation.html'>linearRelation</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>

<span class='co'># basic use</span>
<span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>pollutant</span> <span class='kw'>=</span> <span class='st'>"nox"</span>)</div><div class='img'><img src='timeVariation-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># for a subset of conditions</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'>timeVariation</span>(<span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>mydata</span>, <span class='no'>ws</span> <span class='kw'>&gt;</span> <span class='fl'>3</span> <span class='kw'>&amp;</span> <span class='no'>wd</span> <span class='kw'>&gt;</span> <span class='fl'>100</span> <span class='kw'>&amp;</span> <span class='no'>wd</span> <span class='kw'>&lt;</span> <span class='fl'>270</span>),
<span class='kw'>pollutant</span> <span class='kw'>=</span> <span class='st'>"pm10"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"pm10 (ug/m3)"</span>)
}

<span class='co'># multiple pollutants with concentrations normalised</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) <span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>pollutant</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"nox"</span>, <span class='st'>"co"</span>), <span class='kw'>normalise</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># show BST/GMT variation (see ?cutData for more details)</span>
<span class='co'># the NOx plot shows the profiles are very similar when expressed in</span>
<span class='co'># local time, showing that the profile is dominated by a local source</span>
<span class='co'># that varies by local time and not by GMT i.e. road vehicle emissions</span>

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) <span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>pollutant</span> <span class='kw'>=</span> <span class='st'>"nox"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"dst"</span>, <span class='kw'>local.tz</span> <span class='kw'>=</span> <span class='st'>"Europe/London"</span>)

<span class='co'>## In this case it is better to group the results for clarity:</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) <span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>pollutant</span> <span class='kw'>=</span> <span class='st'>"nox"</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='st'>"dst"</span>, <span class='kw'>local.tz</span> <span class='kw'>=</span> <span class='st'>"Europe/London"</span>)

<span class='co'># By contrast, a variable such as wind speed shows a clear shift when</span>
<span class='co'>#  expressed in local time. These two plots can help show whether the</span>
<span class='co'>#  variation is dominated by man-made influences or natural processes</span>

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) <span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>pollutant</span> <span class='kw'>=</span> <span class='st'>"ws"</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='st'>"dst"</span>, <span class='kw'>local.tz</span> <span class='kw'>=</span> <span class='st'>"Europe/London"</span>)

<span class='co'>## It is also possible to plot several variables and set type. For</span>
<span class='co'>## example, consider the NOx and NO2 split by levels of O3:</span>

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) <span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>pollutant</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"nox"</span>, <span class='st'>"no2"</span>), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"o3"</span>, <span class='kw'>normalise</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## difference in concentrations</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) <span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>poll</span><span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"pm25"</span>, <span class='st'>"pm10"</span>), <span class='kw'>difference</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># It is also useful to consider how concentrations vary by</span>
<span class='co'># considering two different periods e.g. in intervention</span>
<span class='co'># analysis. In the following plot NO2 has clearly increased but much</span>
<span class='co'># less so at weekends - perhaps suggesting vehicles other than cars</span>
<span class='co'># are important because flows of cars are approximately invariant by</span>
<span class='co'># day of the week</span>

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>mydata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='splitByDate.html'>splitByDate</a></span>(<span class='no'>mydata</span>, <span class='kw'>dates</span><span class='kw'>=</span> <span class='st'>"1/1/2003"</span>, <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"before Jan. 2003"</span>, <span class='st'>"After Jan. 2003"</span>))
<span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>pollutant</span> <span class='kw'>=</span> <span class='st'>"no2"</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='st'>"split.by"</span>, <span class='kw'>difference</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
}

<span class='co'>## sub plots can be extracted from the openair object</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>myplot</span> <span class='kw'>&lt;-</span> <span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>pollutant</span> <span class='kw'>=</span> <span class='st'>"no2"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>myplot</span>, <span class='kw'>subset</span> <span class='kw'>=</span> <span class='st'>"day.hour"</span>) <span class='co'># top weekday and plot</span>
}

<span class='co'>## individual plots</span>
<span class='co'>## plot(myplot, subset="day.hour") for the weekday and hours subplot (top)</span>
<span class='co'>## plot(myplot, subset="hour") for the diurnal plot</span>
<span class='co'>## plot(myplot, subset="day") for the weekday plot</span>
<span class='co'>## plot(myplot, subset="month") for the monthly plot</span>

<span class='co'>## numerical results (mean, lower/upper uncertainties)</span>
<span class='co'>## results(myplot, subset = "day.hour") # the weekday and hour data set</span>
<span class='co'>## summary(myplot, subset = "hour") #summary of hour data set</span>
<span class='co'>## head(myplot, subset = "day") #head/top of day data set</span>
<span class='co'>## tail(myplot, subset = "month") #tail/top of month data set</span>

<span class='co'>## plot quantiles and median</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>stati</span><span class='kw'>=</span><span class='st'>"median"</span>, <span class='kw'>poll</span><span class='kw'>=</span><span class='st'>"pm10"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"firebrick"</span>)

<span class='co'>## with different intervals</span>
<span class='fu'>timeVariation</span>(<span class='no'>mydata</span>, <span class='kw'>stati</span><span class='kw'>=</span><span class='st'>"median"</span>, <span class='kw'>poll</span><span class='kw'>=</span><span class='st'>"pm10"</span>, <span class='kw'>conf.int</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.75</span>, <span class='fl'>0.99</span>),
<span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"firebrick"</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>David Carslaw</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Carslaw, Karl Ropkins.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


